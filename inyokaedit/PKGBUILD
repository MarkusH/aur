# Maintainer: Markus Holtermann <aur@markusholtermann.eu>
pkgname=inyokaedit
pkgver=0.3.1
_mainver=0.3
pkgrel=1
pkgdesc='A small markup editor for Inyoka articles (http://ubuntuusers.de/inyoka/). It includes syntax highlighting, offline preview, downloading raw text of existing articles...'
arch=('i686' 'x86_64')
url='https://launchpad.net/inyokaedit/'
license=('GPL3')
depends=('hunspell' 'qtwebkit' 'wget')
makedepends=('bzr' 'gcc')
source=("https://launchpad.net/inyokaedit/$_mainver/$pkgver/+download/inyokaedit-$pkgver-src.tar.gz")
md5sums=('1644e09212d81f843d971e01f3e23d9a')
conflicts=('inyokaedit-bzr')

build() {
    cd "$srcdir/$pkgname-$pkgver-src"
    qmake
    sed -i 's/-lhunspell/-lhunspell-1.3/' Makefile
    make
}

package() {
    cd "$srcdir/$pkgname-$pkgver-src"
    install -d $pkgdir/usr/bin
    install -d $pkgdir/usr/share/$pkgname
    install -d $pkgdir/usr/share/man/{man1,de/man1}
    cp -rf iWikiLinks $pkgdir/usr/share/$pkgname/iWikiLinks
    cp -rf images $pkgdir/usr/share/$pkgname/
    cp -rf lang $pkgdir/usr/share/$pkgname/
    gzip -9 -c man/man1/inyokaedit.1 > $pkgdir/usr/share/man/man1/inyokaedit.1.gz
    gzip -9 -c man/de/man1/inyokaedit.1 > $pkgdir/usr/share/man/de/man1/inyokaedit.1.gz
    cp GetInyokaStyles $pkgdir/usr/share/$pkgname/
    cp inyokaedit $pkgdir/usr/bin/inyokaedit
}
